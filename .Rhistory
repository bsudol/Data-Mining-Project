pr.out=prcomp(iris[, -5], scale=TRUE)
pr.out$center
pr.out$scale
pr.out$rotation
biplot(pr.out, scale=0)
pr.var=pr.out$sdev^2
pve=pr.var/sum(pr.var)
plot(pve, xlab="Principal Component", ylab="Proportion of Variance Explained ", ylim=c(0,1) ,type='b')
plot(cumsum(pve), xlab="Principal Component", ylab="Cumulative Proportion of Variance Explained ", ylim=c(0,1), type='b')
install.packages("pls")
#Principal Component Regression
library(pls)
library(ISLR)
Hitters <- Hitters
sum(is.na(Hitters))
Hitters=na.omit(Hitters)
set.seed(2)
train = sample(1:nrow(Hitters), nrow(Hitters)*2/3)
Hitters.test = Hitters[-train,]
set.seed(2)
pcr.fit = pcr(Salary~., data = Hitters, scale = TRUE, validation = "CV")
validationplot(pcr.fit, val.type = "MSEP")
pcr.pred = predict(pcr.fit, Hitters.test, ncomp = 7)
mean((pcr.pred - Hitters.test$Salary)^2)
pcr.fit.final = pcr(Salary~., data = Hitters, scale = TRUE, ncomp = 7)
summary(pcr.fit.final)
responses <- read.table("responses.csv", header = TRUE, sep =",")
responses$Music <- NULL;responses$Dance <- NULL;responses$Dance<- NULL;responses$Folk<- NULL;responses$Country<-NULL;responses$Classical.music<-NULL;responses$Musical<-NULL;responses$Pop<-NULL;responses$Rock<-NULL;responses$Metal.or.Hardrock<-NULL;responses$Punk<-NULL;responses$Hiphop..Rap<-NULL;responses$Reggae..Ska<-NULL;responses$Swing..Jazz<-NULL;responses$Rock.n.roll<-NULL;responses$Alternative<-NULL;responses$Latino<-NULL;responses$Techno..Trance<-NULL;responses$Opera<-NULL;responses$Movies<-NULL;responses$Horror<-NULL;responses$Thriller<-NULL;responses$Comedy<-NULL;responses$Romantic<-NULL;responses$Sci.fi<-NULL;responses$War<-NULL;responses$Fantasy.Fairy.tales<-NULL;responses$Animated<-NULL;responses$Animated<-NULL;responses$Documentary<-NULL;responses$Western<-NULL;responses$Action<-NULL;responses$History<-NULL;responses$Psychology<-NULL;responses$Politics<-NULL;responses$Mathematics<-NULL;responses$Physics<-NULL;responses$Internet<-NULL;responses$PC<-NULL;responses$Economy.Management<-NULL;responses$Biology<-NULL;responses$Chemistry<-NULL;responses$Reading<-NULL;responses$Geography<-NULL;responses$Foreign.languages<-NULL;responses$Medicine<-NULL;responses$Law<-NULL;responses$Cars<-NULL;responses$Art.exhibitions<-NULL;responses$Religion<-NULL;responses$Countryside..outdoors<-NULL;responses$Dancing<-NULL;responses$Musical.instruments<-NULL;responses$Writing<-NULL
#clean out lines involving music movies and interests for this portion of the study to save data when we omit lines with missing responses. did it manually because it was messing up the CSV when I tried to do it in excel
dim(responses)
#create new applicable variables
responses$Sport = (responses$Active.sport+responses$Passive.sport)/2 #new variable for average 'sportiness'
responses$Interneta[responses$Internet.usage == "most of the day"] <- "1"
responses$Interneta[responses$Internet.usage == "few hours a day"] <- "3"
responses$Interneta[responses$Internet.usage == "less than an hour a day"] <- "5"
responses$Smokingbin[responses$Smoking=="former smoker"] <- "Yes"
responses$Smokingbin[responses$Smoking=="current smoker"] <- "Yes"
responses$Smokingbin[responses$Smoking=="tried smoking"] <- "No"
responses$Smokingbin[responses$Smoking=="never smoked"] <- "No"
responses$BMI = responses$Weight/(responses$Height/100)^2
#finish setting up data make training and test sets
responses <- na.omit(responses)
dim(responses)
View(responses)
set.seed(1)
train_idx = sample(1:nrow(responses), 3/4*nrow(responses))
train_idx = responses[train_idx,]
test_idx = responses[-train_idx,]
#model selection using ANOVA
#GAMS including splines and linear fns of spending on healthy food, concern about health, healthy eating, smoking and drinking habits, sports, internet usage.
#including and excluding age and weight/height
#response variable = Happiness in life (1-5 scale)
library(gam)
library(splines)
gam0 = lm(Happiness.in.life ~ Health + Healthy.eating + Sport + Interneta + Spending.on.healthy.eating + Smoking + Age, data = responses)
summary(gam0)
gam01 = lm(Happiness.in.life ~ Health + Healthy.eating + Sport + Interneta + Spending.on.healthy.eating + Smoking + BMI, data = responses)
summary(gam01)
#R squared is very low here and BMI seems to not be significant as a predictor. Take out some high p value variables and do again:
gam02 = lm(Happiness.in.life ~ Healthy.eating + Sport + Interneta + Spending.on.healthy.eating, data = responses)
summary(gam02)
#ANOVA
#could try to do this twice, one with , subset=(gender!="female") and one for !=male
#take the variables that are included in best subset selection and do an ANOVA
gam1 = lm(Happiness.in.life ~ Sport + Healthy.eating + Interneta + Spending.on.healthy.eating, data = responses)
gam2=gam(Happiness.in.life ~ Sport + Healthy.eating + Interneta + s(Spending.on.healthy.eating), data = responses)
gam3=gam(Happiness.in.life ~ Sport + Healthy.eating + Interneta + s(Spending.on.healthy.eating), data = responses)
gam4=gam(Happiness.in.life ~ poly(Sport,3) + Healthy.eating + Interneta + poly(Spending.on.healthy.eating, 3), data = responses)
gam5=gam(Happiness.in.life ~ Sport + s(Healthy.eating) + Interneta + poly(Spending.on.healthy.eating, 4), data = responses)
gam6=gam(Happiness.in.life ~ s(Sport) + Healthy.eating + Interneta + poly(Spending.on.healthy.eating, 3), data = responses)
anova(gam1, gam2, gam3, gam4, gam5 ,test="F")
#gam2 is the only one that has a good p value here (less than 0.05 means to accept the hypothesis)
summary(gam2)
## SUBSET SELECTIONS ##
library(leaps)
#Upward and downward selection on all variables for happines, max subset size = 20
ss.all.up.20 = regsubsets(Happiness.in.life~.,data=responses,nvmax=20)
getwed()
getwd()
setwd("/Users/alexabren/Documents/GitHub/Data-Mining-Project")
responses <- read.table("responses.csv", header = TRUE, sep =",")
responses$Music <- NULL;responses$Dance <- NULL;responses$Dance<- NULL;responses$Folk<- NULL;responses$Country<-NULL;responses$Classical.music<-NULL;responses$Musical<-NULL;responses$Pop<-NULL;responses$Rock<-NULL;responses$Metal.or.Hardrock<-NULL;responses$Punk<-NULL;responses$Hiphop..Rap<-NULL;responses$Reggae..Ska<-NULL;responses$Swing..Jazz<-NULL;responses$Rock.n.roll<-NULL;responses$Alternative<-NULL;responses$Latino<-NULL;responses$Techno..Trance<-NULL;responses$Opera<-NULL;responses$Movies<-NULL;responses$Horror<-NULL;responses$Thriller<-NULL;responses$Comedy<-NULL;responses$Romantic<-NULL;responses$Sci.fi<-NULL;responses$War<-NULL;responses$Fantasy.Fairy.tales<-NULL;responses$Animated<-NULL;responses$Animated<-NULL;responses$Documentary<-NULL;responses$Western<-NULL;responses$Action<-NULL;responses$History<-NULL;responses$Psychology<-NULL;responses$Politics<-NULL;responses$Mathematics<-NULL;responses$Physics<-NULL;responses$Internet<-NULL;responses$PC<-NULL;responses$Economy.Management<-NULL;responses$Biology<-NULL;responses$Chemistry<-NULL;responses$Reading<-NULL;responses$Geography<-NULL;responses$Foreign.languages<-NULL;responses$Medicine<-NULL;responses$Law<-NULL;responses$Cars<-NULL;responses$Art.exhibitions<-NULL;responses$Religion<-NULL;responses$Countryside..outdoors<-NULL;responses$Dancing<-NULL;responses$Musical.instruments<-NULL;responses$Writing<-NULL
#clean out lines involving music movies and interests for this portion of the study to save data when we omit lines with missing responses. did it manually because it was messing up the CSV when I tried to do it in excel
dim(responses)
#create new applicable variables
responses$Sport = (responses$Active.sport+responses$Passive.sport)/2 #new variable for average 'sportiness'
responses$Interneta[responses$Internet.usage == "most of the day"] <- "1"
responses$Interneta[responses$Internet.usage == "few hours a day"] <- "3"
responses$Interneta[responses$Internet.usage == "less than an hour a day"] <- "5"
responses$Smokingbin[responses$Smoking=="former smoker"] <- "Yes"
responses$Smokingbin[responses$Smoking=="current smoker"] <- "Yes"
responses$Smokingbin[responses$Smoking=="tried smoking"] <- "No"
responses$Smokingbin[responses$Smoking=="never smoked"] <- "No"
responses$BMI = responses$Weight/(responses$Height/100)^2
#finish setting up data make training and test sets
responses <- na.omit(responses)
dim(responses)
View(responses)
set.seed(1)
train_idx = sample(1:nrow(responses), 3/4*nrow(responses))
train_idx = responses[train_idx,]
test_idx = responses[-train_idx,]
#model selection using ANOVA
#GAMS including splines and linear fns of spending on healthy food, concern about health, healthy eating, smoking and drinking habits, sports, internet usage.
#including and excluding age and weight/height
#response variable = Happiness in life (1-5 scale)
library(gam)
library(splines)
gam0 = lm(Happiness.in.life ~ Health + Healthy.eating + Sport + Interneta + Spending.on.healthy.eating + Smoking + Age, data = responses)
summary(gam0)
gam01 = lm(Happiness.in.life ~ Health + Healthy.eating + Sport + Interneta + Spending.on.healthy.eating + Smoking + BMI, data = responses)
summary(gam01)
#R squared is very low here and BMI seems to not be significant as a predictor. Take out some high p value variables and do again:
gam02 = lm(Happiness.in.life ~ Healthy.eating + Sport + Interneta + Spending.on.healthy.eating, data = responses)
summary(gam02)
#ANOVA
#could try to do this twice, one with , subset=(gender!="female") and one for !=male
#take the variables that are included in best subset selection and do an ANOVA
gam1 = lm(Happiness.in.life ~ Sport + Healthy.eating + Interneta + Spending.on.healthy.eating, data = responses)
gam2=gam(Happiness.in.life ~ Sport + Healthy.eating + Interneta + s(Spending.on.healthy.eating), data = responses)
gam3=gam(Happiness.in.life ~ Sport + Healthy.eating + Interneta + s(Spending.on.healthy.eating), data = responses)
gam4=gam(Happiness.in.life ~ poly(Sport,3) + Healthy.eating + Interneta + poly(Spending.on.healthy.eating, 3), data = responses)
gam5=gam(Happiness.in.life ~ Sport + s(Healthy.eating) + Interneta + poly(Spending.on.healthy.eating, 4), data = responses)
gam6=gam(Happiness.in.life ~ s(Sport) + Healthy.eating + Interneta + poly(Spending.on.healthy.eating, 3), data = responses)
anova(gam1, gam2, gam3, gam4, gam5 ,test="F")
#gam2 is the only one that has a good p value here (less than 0.05 means to accept the hypothesis)
summary(gam2)
## SUBSET SELECTIONS ##
library(leaps)
#Upward and downward selection on all variables for happines, max subset size = 20
ss.all.up.20 = regsubsets(Happiness.in.life~.,data=responses,nvmax=20)
ss.all.fwd.20 = regsubsets(Happiness.in.life~.,data=responses,nvmax=20, method = 'forward')
## SUBSET SELECTIONS ##
library(leaps)
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.20 = regsubsets(Happiness.in.life~.,data=responses,nvmax=10, method = 'forward')
## SUBSET SELECTIONS ##
library(leaps)
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.20 = regsubsets(Happiness.in.life~.,data=responses,nvmax=5, method = 'forward')
## SUBSET SELECTIONS ##
library(leaps)
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.20 = regsubsets(Happiness.in.life~.,data=responses,nvmax=1, method = 'forward')
summary(leaps)
help(leaps)
help(regsubsets)
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.20 = regsubsets(Happiness.in.life~.,data=responses,nvmax=1, method = 'forward', intercept=TRUE)
help(detect_lin_dep)
cor(responses)
install.packages("Hmisc")
library(Hmisc)
correlations = rcorr(as.matrix(responses))
for (i in 1:ncol(responses)){
for (j in 1:ncol(responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] < 0.05 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
library(Hmisc)
correlations = rcorr(responses)
help(rcorrr)
help(rcorr)
as.matrix(responses)
lm(Happiness.in.life ~., data=responses)
#nmueric only
num_responses = responses[sapply(responses, is.numeric)]
num_responses
ss.all.fwd.20 = regsubsets(Happiness.in.life~.,data=num_responses,nvmax=5, method = 'forward')
#nmueric only
num_responses = responses[sapply(responses, is.numeric)]
correlations = rcorr(as.matrix(num_responses))
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] < 0.05 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] > 0.05 ) {
print(paste(rownames(correl1tions$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
#nmueric only
num_responses = responses[sapply(responses, is.numeric)]
correlations = rcorr(as.matrix(num_responses))
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] > 0.05 ) {
print(paste(rownames(correl1tions$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] > 0.05 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] < 0.01 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] < 0.00001 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] = 0 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] < 0.00001 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] = 0 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$P[i,j])){
if ( correlations$P[i,j] == 0 ) {
print(paste(rownames(correlations$P)[i], "-" , colnames(correlations$P)[j], ": ", correlations$P[i,j]))
}
}
}
}
rcorr(num_responses$Spending.on.gadgets, num_responses$Spending.on.looks)
rcorr(num_responses$Spending.on.gadgets, num_responses$Spending.on.looks)$P
correlations$r
correlations$P
#nmueric only
num_responses = responses[sapply(responses, is.numeric)]
correlations = rcorr(as.matrix(num_responses))
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$r[i,j])){
if ( abs(correlations$r[i,j]) >= .95 ) {
print(paste(rownames(correlations$r)[i], "-" , colnames(correlations$r)[j], ": ", correlations$r[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$r[i,j])){
if ( abs(correlations$r[i,j]) >= .90 ) {
print(paste(rownames(correlations$r)[i], "-" , colnames(correlations$r)[j], ": ", correlations$r[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$r[i,j])){
if ( (abs(correlations$r[i,j]) >= .90) && (abs(correlations$r[i,j]) != 1 )) {
print(paste(rownames(correlations$r)[i], "-" , colnames(correlations$r)[j], ": ", correlations$r[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$r[i,j])){
if ( (abs(correlations$r[i,j]) >= .80) && (abs(correlations$r[i,j]) != 1 )) {
print(paste(rownames(correlations$r)[i], "-" , colnames(correlations$r)[j], ": ", correlations$r[i,j]))
}
}
}
}
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$r[i,j])){
if ( (abs(correlations$r[i,j]) >= .70) && (abs(correlations$r[i,j]) != 1 )) {
print(paste(rownames(correlations$r)[i], "-" , colnames(correlations$r)[j], ": ", correlations$r[i,j]))
}
}
}
}
num_responses.fixed = subset(num_responses, select = -c(BMI))
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
num_responses.fixed = subset(num_responses, select = -c(Height))
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
#This call failes because there are 8 linear dependencies in our variables - variables that are highly
#correlated (a.k.a, too similar)
num_responses.fixed = subset(num_responses, select = -c(BMI))
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
#This call failes because there are 8 linear dependencies in our variables - variables that are highly
#correlated (a.k.a, too similar)
num_responses.fixed = subset(num_responses, select = -c(BMI, Height))
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight))
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight))
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight))
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
responses <- read.table("responses.csv", header = TRUE, sep =",")
responses$Music <- NULL;responses$Dance <- NULL;responses$Dance<- NULL;responses$Folk<- NULL;responses$Country<-NULL;responses$Classical.music<-NULL;responses$Musical<-NULL;responses$Pop<-NULL;responses$Rock<-NULL;responses$Metal.or.Hardrock<-NULL;responses$Punk<-NULL;responses$Hiphop..Rap<-NULL;responses$Reggae..Ska<-NULL;responses$Swing..Jazz<-NULL;responses$Rock.n.roll<-NULL;responses$Alternative<-NULL;responses$Latino<-NULL;responses$Techno..Trance<-NULL;responses$Opera<-NULL;responses$Movies<-NULL;responses$Horror<-NULL;responses$Thriller<-NULL;responses$Comedy<-NULL;responses$Romantic<-NULL;responses$Sci.fi<-NULL;responses$War<-NULL;responses$Fantasy.Fairy.tales<-NULL;responses$Animated<-NULL;responses$Animated<-NULL;responses$Documentary<-NULL;responses$Western<-NULL;responses$Action<-NULL;responses$History<-NULL;responses$Psychology<-NULL;responses$Politics<-NULL;responses$Mathematics<-NULL;responses$Physics<-NULL;responses$Internet<-NULL;responses$PC<-NULL;responses$Economy.Management<-NULL;responses$Biology<-NULL;responses$Chemistry<-NULL;responses$Reading<-NULL;responses$Geography<-NULL;responses$Foreign.languages<-NULL;responses$Medicine<-NULL;responses$Law<-NULL;responses$Cars<-NULL;responses$Art.exhibitions<-NULL;responses$Religion<-NULL;responses$Countryside..outdoors<-NULL;responses$Dancing<-NULL;responses$Musical.instruments<-NULL;responses$Writing<-NULL
#clean out lines involving music movies and interests for this portion of the study to save data when we omit lines with missing responses. did it manually because it was messing up the CSV when I tried to do it in excel
dim(responses)
#create new applicable variables
responses$Sport = (responses$Active.sport+responses$Passive.sport)/2 #new variable for average 'sportiness'
responses$Interneta[responses$Internet.usage == "most of the day"] <- "1"
responses$Interneta[responses$Internet.usage == "few hours a day"] <- "3"
responses$Interneta[responses$Internet.usage == "less than an hour a day"] <- "5"
responses$Smokingbin[responses$Smoking=="former smoker"] <- "Yes"
responses$Smokingbin[responses$Smoking=="current smoker"] <- "Yes"
responses$Smokingbin[responses$Smoking=="tried smoking"] <- "No"
responses$Smokingbin[responses$Smoking=="never smoked"] <- "No"
responses$BMI = responses$Weight/(responses$Height/100)^2
#finish setting up data make training and test sets
responses <- na.omit(responses)
dim(responses)
View(responses)
set.seed(1)
train_idx = sample(1:nrow(responses), 3/4*nrow(responses))
train_idx = responses[train_idx,]
test_idx = responses[-train_idx,]
#model selection using ANOVA
#GAMS including splines and linear fns of spending on healthy food, concern about health, healthy eating, smoking and drinking habits, sports, internet usage.
#including and excluding age and weight/height
#response variable = Happiness in life (1-5 scale)
library(gam)
library(splines)
gam0 = lm(Happiness.in.life ~ Health + Healthy.eating + Sport + Interneta + Spending.on.healthy.eating + Smoking + Age, data = responses)
summary(gam0)
gam01 = lm(Happiness.in.life ~ Health + Healthy.eating + Sport + Interneta + Spending.on.healthy.eating + Smoking + BMI, data = responses)
summary(gam01)
#R squared is very low here and BMI seems to not be significant as a predictor. Take out some high p value variables and do again:
gam02 = lm(Happiness.in.life ~ Healthy.eating + Sport + Interneta + Spending.on.healthy.eating, data = responses)
summary(gam02)
#ANOVA
#could try to do this twice, one with , subset=(gender!="female") and one for !=male
#take the variables that are included in best subset selection and do an ANOVA
gam1 = lm(Happiness.in.life ~ Sport + Healthy.eating + Interneta + Spending.on.healthy.eating, data = responses)
gam2=gam(Happiness.in.life ~ Sport + Healthy.eating + Interneta + s(Spending.on.healthy.eating), data = responses)
gam3=gam(Happiness.in.life ~ Sport + Healthy.eating + Interneta + s(Spending.on.healthy.eating), data = responses)
gam4=gam(Happiness.in.life ~ poly(Sport,3) + Healthy.eating + Interneta + poly(Spending.on.healthy.eating, 3), data = responses)
gam5=gam(Happiness.in.life ~ Sport + s(Healthy.eating) + Interneta + poly(Spending.on.healthy.eating, 4), data = responses)
gam6=gam(Happiness.in.life ~ s(Sport) + Healthy.eating + Interneta + poly(Spending.on.healthy.eating, 3), data = responses)
anova(gam1, gam2, gam3, gam4, gam5 ,test="F")
#gam2 is the only one that has a good p value here (less than 0.05 means to accept the hypothesis)
summary(gam2)
## SUBSET SELECTIONS ##
install.packages("Hmisc")
library(Hmisc)
#nmueric only
num_responses = responses[sapply(responses, is.numeric)]
correlations = rcorr(as.matrix(num_responses))
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$r[i,j])){
if ( (abs(correlations$r[i,j]) >= .80) && (abs(correlations$r[i,j]) != 1 )) {
print(paste(rownames(correlations$r)[i], "-" , colnames(correlations$r)[j], ": ", correlations$r[i,j]))
}
}
}
}
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight))
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
install.packages("Hmisc")
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight))
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
library(Hmisc)
#nmueric only
num_responses = responses[sapply(responses, is.numeric)]
correlations = rcorr(as.matrix(num_responses))
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$r[i,j])){
if ( (abs(correlations$r[i,j]) >= .80) && (abs(correlations$r[i,j]) != 1 )) {
print(paste(rownames(correlations$r)[i], "-" , colnames(correlations$r)[j], ": ", correlations$r[i,j]))
}
}
}
}
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight))
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
library(leaps)
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'forward')
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'backward')
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses.fixed,nvmax=5, method = 'complete')
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses,nvmax=5, method = 'forward')
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight, Sport))
library(leaps)
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses,nvmax=5, method = 'forward')
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight, Sport, Animated))
library(leaps)
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses,nvmax=5, method = 'forward')
#This call failes because there are 8 linear dependencies in our variables - variables that are highly
#correlated (a.k.a, too similar)
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight, Sport))
View(num_responses.fixed)
responses <- read.table("responses.csv", header = TRUE, sep =",")
responses$Music <- NULL;responses$Dance <- NULL;responses$Dance<- NULL;responses$Folk<- NULL;responses$Country<-NULL;responses$Classical.music<-NULL;responses$Musical<-NULL;responses$Pop<-NULL;responses$Rock<-NULL;responses$Metal.or.Hardrock<-NULL;responses$Punk<-NULL;responses$Hiphop..Rap<-NULL;responses$Reggae..Ska<-NULL;responses$Swing..Jazz<-NULL;responses$Rock.n.roll<-NULL;responses$Alternative<-NULL;responses$Latino<-NULL;responses$Techno..Trance<-NULL;responses$Opera<-NULL;responses$Movies<-NULL;responses$Horror<-NULL;responses$Thriller<-NULL;responses$Comedy<-NULL;responses$Romantic<-NULL;responses$Sci.fi<-NULL;responses$War<-NULL;responses$Fantasy.Fairy.tales<-NULL;responses$Animated<-NULL;responses$Animated<-NULL;responses$Documentary<-NULL;responses$Western<-NULL;responses$Action<-NULL;responses$History<-NULL;responses$Psychology<-NULL;responses$Politics<-NULL;responses$Mathematics<-NULL;responses$Physics<-NULL;responses$Internet<-NULL;responses$PC<-NULL;responses$Economy.Management<-NULL;responses$Biology<-NULL;responses$Chemistry<-NULL;responses$Reading<-NULL;responses$Geography<-NULL;responses$Foreign.languages<-NULL;responses$Medicine<-NULL;responses$Law<-NULL;responses$Cars<-NULL;responses$Art.exhibitions<-NULL;responses$Religion<-NULL;responses$Countryside..outdoors<-NULL;responses$Dancing<-NULL;responses$Musical.instruments<-NULL;responses$Writing<-NULL
#clean out lines involving music movies and interests for this portion of the study to save data when we omit lines with missing responses. did it manually because it was messing up the CSV when I tried to do it in excel
dim(responses)
#create new applicable variables
responses$Sport = (responses$Active.sport+responses$Passive.sport)/2 #new variable for average 'sportiness'
responses$Interneta[responses$Internet.usage == "most of the day"] <- "1"
responses$Interneta[responses$Internet.usage == "few hours a day"] <- "3"
responses$Interneta[responses$Internet.usage == "less than an hour a day"] <- "5"
responses$Smokingbin[responses$Smoking=="former smoker"] <- "Yes"
responses$Smokingbin[responses$Smoking=="current smoker"] <- "Yes"
responses$Smokingbin[responses$Smoking=="tried smoking"] <- "No"
responses$Smokingbin[responses$Smoking=="never smoked"] <- "No"
responses$BMI = responses$Weight/(responses$Height/100)^2
#finish setting up data make training and test sets
responses <- na.omit(responses)
dim(responses)
View(responses)
set.seed(1)
train_idx = sample(1:nrow(responses), 3/4*nrow(responses))
train_idx = responses[train_idx,]
test_idx = responses[-train_idx,]
#model selection using ANOVA
#GAMS including splines and linear fns of spending on healthy food, concern about health, healthy eating, smoking and drinking habits, sports, internet usage.
#including and excluding age and weight/height
#response variable = Happiness in life (1-5 scale)
library(gam)
library(splines)
gam0 = lm(Happiness.in.life ~ Health + Healthy.eating + Sport + Interneta + Spending.on.healthy.eating + Smoking + Age, data = responses)
summary(gam0)
gam01 = lm(Happiness.in.life ~ Health + Healthy.eating + Sport + Interneta + Spending.on.healthy.eating + Smoking + BMI, data = responses)
summary(gam01)
#R squared is very low here and BMI seems to not be significant as a predictor. Take out some high p value variables and do again:
gam02 = lm(Happiness.in.life ~ Healthy.eating + Sport + Interneta + Spending.on.healthy.eating, data = responses)
summary(gam02)
#ANOVA
#could try to do this twice, one with , subset=(gender!="female") and one for !=male
#take the variables that are included in best subset selection and do an ANOVA
gam1 = lm(Happiness.in.life ~ Sport + Healthy.eating + Interneta + Spending.on.healthy.eating, data = responses)
gam2=gam(Happiness.in.life ~ Sport + Healthy.eating + Interneta + s(Spending.on.healthy.eating), data = responses)
gam3=gam(Happiness.in.life ~ Sport + Healthy.eating + Interneta + s(Spending.on.healthy.eating), data = responses)
gam4=gam(Happiness.in.life ~ poly(Sport,3) + Healthy.eating + Interneta + poly(Spending.on.healthy.eating, 3), data = responses)
gam5=gam(Happiness.in.life ~ Sport + s(Healthy.eating) + Interneta + poly(Spending.on.healthy.eating, 4), data = responses)
gam6=gam(Happiness.in.life ~ s(Sport) + Healthy.eating + Interneta + poly(Spending.on.healthy.eating, 3), data = responses)
anova(gam1, gam2, gam3, gam4, gam5 ,test="F")
#gam2 is the only one that has a good p value here (less than 0.05 means to accept the hypothesis)
summary(gam2)
## SUBSET SELECTIONS ##
#install.packages("Hmisc")
library(Hmisc)
#nmueric only
num_responses = responses[sapply(responses, is.numeric)]
correlations = rcorr(as.matrix(num_responses))
for (i in 1:ncol(num_responses)){
for (j in 1:ncol(num_responses)){
if ( !is.na(correlations$r[i,j])){
if ( (abs(correlations$r[i,j]) >= .80) && (abs(correlations$r[i,j]) != 1 )) {
print(paste(rownames(correlations$r)[i], "-" , colnames(correlations$r)[j], ": ", correlations$r[i,j]))
}
}
}
}
num_responses.fixed = subset(num_responses, select = -c(BMI, Height, Weight, Animated, Sport))
library(leaps)
#Forward and Backward selection on all variables for happines, max subset size = 10
ss.all.fwd.5 = regsubsets(Happiness.in.life~.,data=num_responses,nvmax=5, method = 'forward')
